<section class="yze-actor-sheet">

  <header class="yze-header">
    <div class="yze-title">
      <h2 class="actor-name">
        <input type="text"
               name="name"
               value="{{actor.name}}"
               {{#unless @root.editable}}disabled{{/unless}} />
      </h2>
      {{#if yze.hasActiveSetting}}
        <p class="hint">Active setting: <strong>{{yze.activeSetting.name}}</strong> ({{yze.activeSetting.id}})</p>
      {{/if}}
    </div>
  </header>

  {{#if yze.hasActiveSetting}}

    {{!-- LAST ROLL --}}
    <section class="yze-block yze-last-roll">
      <h3>Last Roll</h3>
      {{#if lastRoll}}
        <div class="yze-row yze-last-roll-row">
          <label class="yze-label">{{lastRoll.label}}</label>
          <span class="yze-subtle">Successes: {{lastRoll.successes}}</span>
          <span class="yze-subtle">Banes: {{lastRoll.banes}}</span>
          <span class="yze-subtle">Pushed: {{#if lastRoll.pushed}}Yes{{else}}No{{/if}}</span>
        </div>
      {{else}}
        <p class="hint">No rolls yet.</p>
      {{/if}}
    </section>

    {{!-- MODIFIERS --}}
    <section class="yze-block yze-modifiers">
      <h3>Modifiers</h3>
      <div class="yze-modifier-list">
        {{#each modifiers as |mod|}}
          <div class="yze-row yze-modifier-row" data-modifier-id="{{mod.id}}">
            <input type="checkbox"
                   data-action="toggleModifier"
                   data-id="{{mod.id}}"
                   {{#if mod.enabled}}checked{{/if}}
                   {{#unless @root.editable}}disabled{{/unless}} />

            <input type="text"
                   class="yze-input"
                   placeholder="Source"
                   data-action="editModifier"
                   data-field="source"
                   data-id="{{mod.id}}"
                   value="{{mod.source}}"
                   {{#unless @root.editable}}disabled{{/unless}} />

            <input type="number"
                   class="yze-input"
                   data-action="editModifier"
                   data-field="value"
                   data-id="{{mod.id}}"
                   value="{{mod.value}}"
                   step="1"
                   {{#unless @root.editable}}disabled{{/unless}} />

            <button type="button"
                    data-action="removeModifier"
                    data-id="{{mod.id}}"
                    {{#unless @root.editable}}disabled{{/unless}}>
              Remove
            </button>
          </div>
        {{/each}}
      </div>

      <button type="button"
              data-action="addModifier"
              {{#unless @root.editable}}disabled{{/unless}}>
        + Add Modifier
      </button>
    </section>

    {{!-- CONDITIONS --}}
    <section class="yze-block yze-conditions">
      <h3>Conditions</h3>
      {{#if conditions.length}}
        <div class="yze-condition-list">
          {{#each conditions as |cond|}}
            <div class="yze-row yze-condition-row" data-condition-id="{{cond.id}}">
              <input type="checkbox"
                     data-action="toggleCondition"
                     data-id="{{cond.id}}"
                     {{#if cond.enabled}}checked{{/if}}
                     {{#unless @root.editable}}disabled{{/unless}} />

              <span class="yze-label" title="{{cond.description}}">
                {{cond.name}}
              </span>

              {{#if cond.stacks}}
                <div class="yze-condition-stacks">
                  <button type="button"
                          data-action="adjustConditionStacks"
                          data-id="{{cond.id}}"
                          data-delta="-1"
                          {{#unless @root.editable}}disabled{{/unless}}>
                    -
                  </button>
                  <span class="yze-subtle">x{{cond.stacks}}</span>
                  <button type="button"
                          data-action="adjustConditionStacks"
                          data-id="{{cond.id}}"
                          data-delta="1"
                          {{#unless @root.editable}}disabled{{/unless}}>
                    +
                  </button>
                </div>
              {{/if}}
            </div>
          {{/each}}
        </div>
      {{else}}
        <p class="hint">No conditions defined in the active setting.</p>
      {{/if}}
    </section>

    {{!-- ITEMS --}}
    <section class="yze-block yze-items">
      <h3>Items</h3>
      {{#if items.length}}
        <div class="yze-item-list">
          {{#each items as |item|}}
            <div class="yze-row yze-item-row" data-item-id="{{item.id}}">
              <input type="checkbox"
                     data-action="toggleItemEquipped"
                     data-item-id="{{item.id}}"
                     {{#if item.equipped}}checked{{/if}}
                     {{#unless @root.editable}}disabled{{/unless}} />

              <span class="yze-label">{{item.name}}</span>

              <button type="button"
                      data-action="editItem"
                      data-item-id="{{item.id}}">
                Edit
              </button>
            </div>
          {{/each}}
        </div>
      {{else}}
        <p class="hint">No items yet.</p>
      {{/if}}

      <button type="button"
              data-action="createItem"
              {{#unless @root.editable}}disabled{{/unless}}>
        + New Item
      </button>
    </section>

    {{!-- ATTRIBUTES --}}
    <section class="yze-block">
      <h3>Attributes</h3>

      <div class="yze-grid yze-grid-attrs">
        {{#each attributesRendered as |attr|}}
          <div class="yze-row yze-attr" data-attr="{{attr.id}}">
            <button type="button"
                    class="yze-roll"
                    data-action="rollAttr"
                    data-attr-id="{{attr.id}}">
              Roll
            </button>

            <label class="yze-label">{{attr.name}}</label>

            <input type="number"
                   class="yze-input"
                   name="system.attributes.{{attr.id}}.value"
                   value="{{attr.value}}"
                   min="0"
                   step="1"
                   {{#unless @root.editable}}disabled{{/unless}} />
          </div>
        {{/each}}
      </div>
    </section>

    {{!-- SKILLS --}}
    <section class="yze-block">
      <h3>Skills</h3>

      <div class="yze-grid yze-grid-skills">
        {{#each skillsRendered as |skill|}}
          <div class="yze-row yze-skill" data-skill="{{skill.id}}">
            <button type="button"
                    class="yze-roll"
                    data-action="rollSkill"
                    data-skill-id="{{skill.id}}"
                    data-attr-id="{{skill.attribute}}">
              Roll
            </button>

            <label class="yze-label">
              {{skill.name}}
              <span class="yze-subtle">({{skill.attribute}})</span>
            </label>

            <input type="number"
                   class="yze-input"
                   name="system.skills.{{skill.id}}.value"
                   value="{{skill.value}}"
                   min="0"
                   step="1"
                   {{#unless @root.editable}}disabled{{/unless}} />
          </div>
        {{/each}}
      </div>
    </section>

   {{!-- RESOURCES --}}
  {{#if resourcesRendered}}
    <section class="yze-block">
      <h3>Resources</h3>

      <div class="yze-grid yze-grid-resources">
        {{#each resourcesRendered as |res|}}
          <div class="yze-row yze-resource" data-resource="{{res.resId}}">
            <label class="yze-label">{{res.name}}</label>

            <input type="number"
                  class="yze-input"
                  name="{{res.path}}"
                  value="{{res.value}}"
                  min="0"
                  step="1"
                  {{#unless @root.editable}}disabled{{/unless}} />

            {{#if res.maxPath}}
              <span class="yze-subtle">/</span>
              <input type="number"
                    class="yze-input yze-input-max"
                    name="{{res.maxPath}}"
                    value="{{res.max}}"
                    min="0"
                    step="1"
                    {{#unless @root.editable}}disabled{{/unless}} />
            {{/if}}
          </div>
        {{/each}}
      </div>
    </section>
  {{/if}}

  {{else}}

    <section class="yze-block">
      <p class="warning">
        No active setting. Activate or load a setting to display attributes, skills, and resources.
      </p>
      <p class="hint">
        (Dev) If you expected the example setting: enable <em>Enable Dev Example Setting</em> and reload the world.
      </p>
    </section>

  {{/if}}

</section>
